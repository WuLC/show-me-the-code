F.module("mancard:skeleton/card",function(c,b,a){var d=(function(){var e=/<link[^>]*href="(.*?)"[^>]*>/;var i=$("#s_menus_wrapper");var l=$("#s_ctner_menus");var f="";function k(o,m,n){this.id=(""+o)||"";this.loaded=0;this.offsetUsed=false;this.html="";this.name=m||"";this.state=n||"";this.mainDom=$("#s_content_"+this.id);this.mainDom=this.mainDom[0]?this.mainDom:j({id:this.id});this.waterDom=null;this.noMore=false;this.myMen=null;this.rendered=false;this.waterPage=0;this.waterLoading=false;this.prevRidsArr=window.s_session.rids||[];this.repeatNum=0;this.ridsHash={};this.params={};this.forceLoad=false}k.prototype={constructor:k,load:function(m){var n=this;if(n.id!=""){if(n.loaded===0||n.forceLoad){n.loaded=1;n.params.id=n.id;g(n.params,function(r){n.loaded=2;n.sessionId=r.sessionId;n.prevRidsArr=r.rids;for(var q=0,p=r.rids||[],o=p.length;q<o;q++){n.ridsHash[p[q]]=true}n.html=r.html.replace(e,"");if(r.isEnd==1){n.noMore=true}n.loadCss(r.html,m)})}}},loadCss:function(p,m){var o,n;if(p){o=p.match(e);if(o){n=o[1];$('<link rel="stylesheet" type="text/css" href="'+n+'" />').on("load",function(){m&&m(p)}).appendTo(head);if($.browser.safari&&window.navigator.platform==="Win32"){m&&m(p)}}else{m&&m(p)}}else{a.fire("syncNomore",{cardId:this.id})}},appendData:function(p,r,u){var n=this;if(n.noMore||n.waterLoading||!n.rendered){if(n.noMore){r&&r(false)}return false}if(!n.loadDom){n.loadDom=n.mainDom.find(".s-loading")}n.waterLoading=true;r&&r(false);var q={id:n.id,offset:n.waterPage,sessionId:n.sessionId};var s=(n.mainDom||$("#s_content_"+n.id));var o=s.attr("data-waterpara");if(!o&&s.find(".s-xmancard").attr("data-waterpara")){o=s.find(".s-xmancard").attr("data-waterpara")}if(o){var m=/([s\S]*?)\=([\s\S]*?)\;/g;var t=null;while((t=m.exec(o))){if(t[1]==="offset"){if(!n.offsetUsed){q[t[1]]=t[2];n.waterPage=t[2];n.offsetUsed=true}}else{q[t[1]]=t[2]}}}n.loadDom.show();F.use("mancard:skeleton/model",function(v){v.get("waterHtml",function(y){if(!n.waterDom){n.waterDom=$(".water-container",n.mainDom)}if(q.childId==="1_1"&&q.sessionId==="0"){n.ridsHash={}}var x=n.validateRid(y);var w=[function(){var z=u||n.waterDom;z.append(y.html);n.waterLoading=false;n.loadDom.hide();if(y.isEnd=="1"){n.emitNoMore(n.loadDom);n.noMore=true}n.waterPage++;n.mainDom.attr("data-loaded",1);if(n.id==2&&y.isEnd=="0"){n.mainDom.find("div[data-waterpara]").attr("data-waterpara","version="+y.version+";"+y.waterpara)}a.fire("cardloaded",{cardId:n.id,loadData:y});p&&p.call(n,y)},function(){n.waterLoading=false;n.appendData(p,r)},function(){$.ajaxpost(s_domain.baseuri+"/page/data/pageserver",{errno:7009});n.emitNoMore(n.loadDom);n.noMore=true}];f=(f===""||f==1)?"1":undefined;w[x]()},q)});return true},validateRid:function(r){var n=this;var q=r.rids||[];var p=0;for(var o=0,m=q.length;o<m;o++){if(!!q[o]&&!!n.ridsHash[q[o]]){p=1}n.ridsHash[q[o]]=true}if(p===1){n.repeatNum++}else{if(n.repeatNum===1){n.repeatNum=0}}n.prevRidsArr=q;return n.repeatNum},render:function(m){var n=this;$("#s_ctner_contents").append(this.mainDom);n.load(function(o){var p=$(n.html);n.mainDom.html(p);if(n.noMore){n.emitNoMore(n.mainDom.find(".s-loading"))}n.rendered=true;m&&m();a.fire("cardinitloaded")});return n},add2Men:function(m){var n=this;if(!n.myMen){var o=h({id:this.id,name:this.name});n.myMen=$(o)}if(this.id==="3"){i.parent().append(n.myMen);F.call("newmusic:index","init")}else{i.append(n.myMen)}n.myMen.show();n.render();return n},del4Men:function(m){var n=this;if((n.myMen=$("[data-id="+this.id+"]",i))[0]){n.myMen.hide();n.mainDom.hide();n.state=""}return n},show:function(m){var n=this;if(this.rendered){if(f==1&&this.waterPage==0){this.appendData(function(o){})}this.mainDom.stop().show()}else{this.render(function(){m&&m.call(this)});this.mainDom.stop().show()}m&&m.call(this);this.getMyMen().addClass("current");return this},hide:function(m){this.mainDom.stop().hide();this.getMyMen().removeClass("current");m&&m.call(this);return this},getMyMen:function(){return this.myMen||(this.myMen=$("[data-id="+this.id+"]",l))},emitNoMore:function(m){m=m||this.mainDom.find(".s-loading");m.find(".load-text").addClass("no-more").html("没有更多内容了").end().find("img").hide().end().prepend('<div class="load-done"></div>').show();if(this.id==100||this.id=="1"||this.id=="22"){m.hide()}a.fire("cardLoadDone",{cardId:this.id})},resetNoMore:function(m){m=m||this.mainDom.find(".s-loading");m.hide().find(".load-text").removeClass("no-more").html("正在加载中").end().find("img").show().end().find(".load-done").remove()},setForceLoad:function(m){this.forceLoad=m},addParam:function(m,n){this.params[m]=n}};function h(n){var m;if(n.id==="3"){m='<div class="s-menu-music" data-id="#{id}"></div>'}else{if(n.id==="5"){m='<span class="s-menu-item s-opacity-white-background" data-id="#{id}">',"<span>#{name}</span>",'<span class="bar-bg" data-tid="7779"></span>',"</span>"}else{m=['<span class="s-menu-item s-opacity-white-background" data-id="#{id}">',"#{name}","</span>"].join("")}}return $.formatString(m,n)}function j(n){var m='<div id="s_content_#{id}" data-id="#{id}" class="s-content" style="display:none;"><div class="s-content-load s-opacity-white-background"><img src="#{staticUrl}static/superman/img/loading.gif?v=62199978.gif" /><div>加载中，精彩马上呈现</div></div></div>';$.extend(n,{staticUrl:s_domain.staticUrl});return $($.formatString(m,n))}function g(n,m){if(n.id==="5"&&!(n.childId)){n.childId="0"}n.isPull=(f||"");F.use("mancard:skeleton/model",function(o){o.get("cardHtml",function(p){m&&m(p)},n)})}return k})();return d});F.module("mancard:skeleton/model",function(d,a,c){var f="/home/pcweb/";function g(){}var e={waterHtml:function(h,k){var i=k.id||0,j=k.page||1;if(+k.noload===1){h&&h({html:""})}else{$.ajaxget(f+"data/mancardwater?"+$.param(k),function(l){h&&h(l)})}},cardHtml:function(h,j){var i=$.param(j);$.ajaxget(f+"data/mancardhtml?"+i,function(k){h&&h(k)})}};var b={curmenu:function(i,h,j){var k=i||0;$.ajaxpost(f+"submit/mancardmenu",{id:i},function(l){h&&h(l)})}};g.prototype={get:function(i,h,j){return(e[i]&&e[i](h,j))||false},set:function(i,j,h,k){return(b[i]&&b[i](j,h,k))||false}};return new g()});F.module("mancard:skeleton/card_collection",function(d,b,a){var e=d("mancard:skeleton/card");var h=$("#s_menu_gurd");var g=$("#s_top_wrap");var c=$("#s_mancard_main .s-menu-container");function f(){this.pool={};this.curId=s_session.curmod;this._options={};this.menuTopShowed=false}f.prototype={constructor:f,add:function(k,i,j){if(k instanceof e){return(this.pool[k.id]=k)}else{if(typeof parseInt(k)=="number"&&i!=null&&j!=null){return(this.pool[""+k]=new e(k,i,j))}}return k},remove:function(i){if(i instanceof e){this.pool[i.id]=null}else{if(typeof parseInt(i)=="number"){this.pool[""+i]=null}}return i},get:function(i){return this.pool[""+i]},createCard:function(k,i,j){if(this.pool[k]){return this.pool[""+k]}return new e(k,i,j)},switchCard:function(l,j){var k=this;if($("#s_top_wrap").hasClass("s-down")){if(k.pool[""+l].waterPage==0){if($.isIE<9){k.fixIE(0,function(){})}else{window.scrollTo($(window).scrollLeft(),0)}}else{var i=Math.max($("#s_ctner_contents").offset().top-110,0);k.fixIE(i,function(){})}}k.cardDone(l,j)},cardDone:function(k,i){var j=this;j.pool[j.curId].hide(function(){j.pool[""+k].show(function(){window.s_session.curmod=j.curId=""+k;F.use("mancard:skeleton/model",function(l){l.set("curmenu",j.curId)});i&&i()})})},getMenuIDS:function(){var i=$("#s_menus_wrapper").find(".s-menu-item"),j=[];$.each(i,function(k,l){j.push($(l).attr("data-id"))});return j},toggleMenu:function(i,k){var j=this;var l=g.children(".s-top-nav");if(!!i){h.addClass("s-down");if($("#s_upfunc_menus .s-lite").hasClass("hide-icon")){l.append(h)}if(!j.menuTopShowed){l.css("display","block");h.css({marginTop:-1*h.height()}).stop().animate({marginTop:"0"},150)}j.menuTopShowed=true}else{if(k){h.removeClass("s-down");c.append(h)}else{h.css({marginTop:"0"}).stop().animate({marginTop:-1*h.height()},150,function(){l.css("display","none")})}j.menuTopShowed=false}a.fire("showTopMenu",{show:i})},options:function(){switch(arguments.length){case 0:return this._options;case 1:return this._options[arguments[0]];case 2:return(this._options[arguments[0]]=arguments[1])}},fixIE:function(k,i){var j=this;$("html,body").animate({scrollTop:k},500,function(){i&&i.call(j)})}};return new f()});F.addLog("mancard:skeleton/card_showLog",["cardItemShow"]);F.module("mancard:skeleton/card_showLog",function(c,e,i){var b=c("skeleton/card_collection");var f={};var a=$(window).height();var g={logactid:"1100000004"};function h(){var m=$("#s_content_"+b.curId),s=m.find("[data-rid]"),w=null,j=f[b.curId]||[];var v=[],x=[],q=[],k={};for(var r=0;r<s.length;r++){w=s.eq(r);var o=w.attr("data-extra");var u=w.attr("data-rid");var l;var t=w.attr("data-log");if(t){t=t.replace(/\;$/g,"")}if($.inArray(u,j)!=-1){continue}if((w.offset().top+w.height()/2)-$(window).scrollTop()<a){if(/logactid/g.test(t)){if(t){d(t,k)}j.push(u);var n={};for(var r in k){n[r]=k[r].join(",")}i.fire("cardItemShow",n);continue}if($.inArray(u,j)==-1){v.push(u);if(t){d(t,k)}x.push(r);j.push(u);q.push(o)}}}f[b.curId]=j;if(v.length!=0){var n={rids:v.join(","),pos:x.join(","),extra:q.join(",")};for(var r in k){n[r]=k[r].join(",")}var p=$.extend({},g,n);i.fire("cardItemShow",p)}}function d(k,q){var l=[];var o="";var p="";var n=k.split(";");for(var m=0;m<n.length;m++){l=n[m].split(":");o=l[0];p=l[1];if(!/-0$/g.test(o)){if(/-1$/g.test(o)){o=o.replace(/-1$/g,"")}if(!q[o]){q[o]=[]}q[o].push(p)}}}e.itemShowLog=h});F.module("mancard:skeleton/presenter",function(e,w,m){var o=window;var c=e("skeleton/card_collection");var b=e("skeleton/card_showLog");var t=$("#s_mancard_main");var v=$("#s_ctner_menus");var f=$("#s_ctner_contents");var h=$(".s-menu-container",t);var j={};var i=$.parseJSON($.trim($("#s_menus_textarea",t).html()));var g=$(o).height();var u={};var a=true;function q(){n();k();if(s_session.sid.indexOf("18005")!==-1){d.initToolBar($.isIE===6)}}function n(){var B=i.data;var A=B.length;while(A--){var C=B[A];if(C.state==="1"){c.add(C.id,C.name,C.state)}}if(s_session.curmod==="3"){c.switchCard(100)}var y=c.get(s_session.curmod);if(o._card_aync){if(i.illegal){y.params.normal=1}y.show(function(){if(i.illegal){delete y.params.normal}})}else{y.rendered=true;y.noMore=!!parseInt(i.isEnd,10);y.sessionId=o.s_session.sessionId}for(var A=0,z=o.s_session.rids||[],x=z.length;A<x;A++){y.ridsHash[z[A]]=true}if(y.noMore){y.emitNoMore()}s.toggleMore(!parseInt(i.isEnd));setTimeout(function(){m.fire("modShow",{showTab:c.curId,opType:"refresh"});b.itemShowLog()},1000)}var d={latestY:$(o).scrollTop(),barTop:h.offset().top,barHeight:v.height(),topWrap:$("#s_top_wrap"),centTop:f.offset().top+parseInt(f.css("padding-top"),10),showed:false,overCenter:false,menuGurd:$("#s_menu_gurd",t),container:$(".s-menu-container",t),toolBar:$("#s_top_feed",t),toolBarTop:Math.min(parseInt($("#s_top_feed",t).css("top"),10),300),menuStatus:c.options("menuStatus",0),toggleMenu:function(A){if($.isIE===6){return}var x=this;if(A===x.latestY){return}var z=$.isIE==7?10:3;if((A<x.latestY)&&(x.barTop-A<=x.topWrap.height()+z)){if(!x.showed){c.toggleMenu(true);x.showed=true;c.options("menuStatus",1)}}else{var y=(x.barTop-A>x.topWrap.height()+z);if(x.showed){c.toggleMenu(false,y);x.showed=false}if(x.barTop-A>x.topWrap.height()){c.options("menuStatus",0)}else{c.options("menuStatus",2)}}if((x.centTop-A)<x.topWrap.height()){if(!x.overCenter){m.fire("overCenter",{over:true});x.overCenter=true}}else{if(x.overCenter){m.fire("overCenter",{over:false});x.overCenter=false}}x.latestY=A;if(c.options("menuStatus")==1){$(".mine-tips").hide()}else{if(s_session.userTips&&(s_session.userTips.mineNavTips&&s_session.userTips.mineNavTips!="off")){$(".mine-tips").show()}}},judgeMenu:function(y){var x=this;if(y>0){x.toolBar.find(".to-top").css({visibility:"visible"})}else{x.toolBar.find(".to-top").css({visibility:"hidden"})}},initAdjust:function(){var x=$("#head_wrapper");$(o).on("unload",function(){$(".s-news-rank-wrapper",t).hide();x.removeClass("s-down");o.scrollTo(0,0)})},feedRoller:function(y){if($.isIE!==6){return}var x=this;_top=Math.min((x.toolBarTop+y),f.height()-x.toolBar.height());x.toolBar.css({top:_top})},initToolBar:function(x){var y=this;y.toolBar.css({visibility:"visible"});if(x){return}y.resetToolPos();$(o).on("resize",y.resetToolPos);$(o).on("scroll",y.resetToolPos);$(o).on("s-skinoff",y.resetToolPos);$(o).on("s-skinon",y.resetToolPos)},removeToolCalc:function(){var x=this;if($.isIE===6){return}x.resetToolPos(true)},resetToolPos:function(y){var x=d;var z;var C;var A=y===true?"animate":"css";if(!s.loaded){var C=$(o).height()-x.toolBar.height()-10;var B=f.offset().top+f.outerHeight()-x.toolBar.height()-$(o).scrollTop()-1;var D=f.offset().top+217-$(o).scrollTop();z=Math.max(Math.min(C,B),D)}else{var C=$(o).height()-x.toolBar.height()-30;var D=f.offset().top+227-$(o).scrollTop();z=Math.max(C,D)}if(x.rememberTop!==z){x.toolBar[A]({top:z});x.rememberTop=z}if($(window).width()<1000){x.toolBar.css({left:501-$(window).scrollLeft()})}else{x.toolBar.css({left:"50%"})}}};var s={defaulSub:300,tolerance:a?0:300,preTop:0,loaded:false,moreBar:t.find(".s-more-bar"),judgeFire:function(){var x=this;if(o.s_session.userTips.manhGuide){return}if(x.tolerance===0){return}c.get(c.curId).appendData(function(y){x.loaded=true;if(s_session.sid.indexOf("18005")!==-1){d.removeToolCalc()}},s.toggleMore)},toggleMore:function(x){if(!x){s.moreBar.remove()}else{s.moreBar.show()}},moreUpFy:function(A,x){var z=new Image();var y=this;s.moreBar.css({visibility:"visible"});if(x){if(y.moreUp){var C=f.offset().top+f.height()-$(o).height()-$(o).scrollTop();s.moreBar.css({bottom:Math.min(Math.max(0,C),10)})}}if($(o).height()<830){if(y.moreUp!==true){s.moreBar.addClass("s-more-up").appendTo(f);y.moreUp=true;var C=f.offset().top+f.height()-$(o).height()-$(o).scrollTop();s.moreBar.css({bottom:Math.min(Math.max(0,C),10)});function B(D){s.moreBar.find(".animate-arrow").animate({top:D?18:8},800,"swing",function(){B(!D)})}B(true)}}else{if(y.moreUp!==false){s.moreBar.removeClass("s-more-up");f.after(s.moreBar);if(!y.morePngLoaded){s.moreBar.find(".rect")[0].onload=function(){s.moreBar.css({visibility:"visible"})};y.morePngLoaded=true}y.moreUp=false}if(A===true){s.moreBar.find(".rect").attr("src",s_domain.staticUrl+"static/mancard/img/more_white_7e7e7f63.png")}else{if(A===false){s.moreBar.find(".rect").attr("src",s_domain.staticUrl+"static/mancard/img/more_black_da813ffa.png")}}}},moreDownFy:function(){if($(o).height()>700){var x=t.find(".s-more-bar").addClass("s-more-up").find(".rect").attr("src",s_domain.staticUrl+(o.s_session.userIsNewSkined==="on"?"static/mancard/img/more_white_7e7e7f63.png":"static/mancard/img/more_black_da813ffa.png")).end();f.after(x)}}};function r(){c.toggleMenu(true);d.showed=true;c.options("menuStatus",1)}function l(){var x={product_id:1};bds.qa.ShortCut.initRightBar(x);$("#fb_baidu_wizard").css({height:"100%"})}function k(){var z=null;v.delegate(".s-menu-item","click",function(C){var B=$(this);var D=B.attr("data-id");var A=c.curId;if(c.curId!==D){c.switchCard(D,function(){s.toggleMore(!parseInt(c.get(c.curId).waterPage)&&!c.get(c.curId).noMore)});s.toggleMore(!parseInt(c.get(c.curId).waterPage)&&!c.get(c.curId).noMore);m.fire("switchCard",{toCard:D,fromCard:A})}if(D=="100"){t.find(".mine-tips").hide();F.use("superman:common/user_attr",function(E){if(E.getAttr&&E.getAttr("mineNavTips")){E.setAttr("mineNavTips","off")}})}F.use("mancard:setting/card_setting",function(E){E.hide()});setTimeout(function(){m.fire("modShow",{showTab:c.curId,opType:"click"});m.fire("modClick",{clickTab:c.curId});b.itemShowLog()},500);F.use("superman:common/user_attr",function(E){if(E.getAttr&&E.getAttr("firstMahattan")){var G=c.getMenuIDS().join(",");$.ajaxpost(s_domain.baseuri+"/pcweb/submit/mancardmod",{cmd:"sort",ids:G});E.setAttr("firstMahattan","off")}});C.stopPropagation()}).delegate(".s-menu-item","mouseenter",function(B){var A=$(this);var D=A.attr("data-id");var C=+new Date();j[D]={start:C};j[D].timeId=setTimeout(function(){if(!c.get(D).rendered){c.get(D).render()}},150);B.stopPropagation()}).delegate(".s-menu-item","mouseleave",function(C){var B=$(this);var E=B.attr("data-id");var D=j[E];var A=+new Date();if(D&&D.start){if(A-D.start<150){clearTimeout(D.timeId)}}C.stopPropagation()}).delegate(".s-menu-setting","click",function(A){F.use("mancard:setting/card_setting",function(B){if(!B.isShow()){B.show({current:$("#s_menus_wrapper").find(".current").attr("data-id")})}else{B.hide()}})}).delegate(".s-music-entry","mouseenter",function(){F.call("newmusic:player_exp","init")});t.delegate(".s-more-bar","click",function(A){s.tolerance=s.defaulSub;s.judgeFire();m.fire("loadMoreClick");A.stopPropagation()}).delegate(".to-top","click",function(A){$("body,html").animate({scrollTop:0});m.fire("gotoTopClick");A.stopPropagation()}).on("mouseenter mouseleave",".s-qrcode",function(B){var A=$(this);if(B.type==="mouseenter"){if($(o).width()<=1300){$("#s_top_feed .s-qrcode").addClass("minify")}else{$("#s_top_feed .s-qrcode").removeClass("minify")}A.addClass("icon-over");m.fire("qrcodehover")}else{if(B.type==="mouseleave"){A.removeClass("icon-over")}}B.stopPropagation()}).delegate("#s_top_feed .to-top","mouseenter mouseleave",function(A){if(A.type==="mouseenter"){$(this).addClass("icon-over")}else{if(A.type==="mouseleave"){$(this).removeClass("icon-over")}}A.stopPropagation()}).delegate(".tips-text","click",function(A){c.switchCard("100");t.find(".mine-tips").hide();F.use("superman:common/user_attr",function(B){if(B.getAttr&&B.getAttr("mineNavTips")){B.setAttr("mineNavTips","off")}});A.preventDefault();A.stopPropagation()}).delegate(".tips-close","click",function(A){t.find(".mine-tips").hide();F.use("superman:common/user_attr",function(B){if(B.getAttr&&B.getAttr("mineNavTips")){B.setAttr("mineNavTips","off")}});A.preventDefault();A.stopPropagation()});m.listen("mancard:setting/card_setting",["hideMain","showSet","hideSet"],function(D){if(D.cmd==="add"){(c.get(D.id)||c.add(D.id,D.name,"1")).add2Men();z=D.id}else{if(D.cmd==="del"){var E=0;c.get(D.id).del4Men();for(E in c.pool){break}z=E}else{if(D.cmd==="sort"){var B=$("#s_menus_wrapper");$.each(D.ids,function(H,I){c.get(I).getMyMen().appendTo(B)})}else{if(D._EVENT_NAME==="hideMain"){var A=$("#s_top_wrap").hasClass("s-down")?(($.isIE===8||$.isIE===7)?2500:400):0;$("html,body").animate({scrollTop:0},A,function(){$("#head_wrapper").addClass("s-ps-islite");$("#s_main").hide();$("#s_mancard_newmusic").hide();$("#s_mancard_newmusic").remove();$("#s_upfunc_menus .s-lite").removeClass("hide-icon");F.use("superman:common/user_attr",function(H){H.setAttr("isLite",true)})})}else{if(D._EVENT_NAME==="showSet"){z=null}else{if(D._EVENT_NAME==="hideSet"){z=null;var B=$("#s_menus_wrapper");var G=c.getMenuIDS();var C=$(".s-menu-music");if(C.length>0&&C.css("display")!=="none"){G.unshift(C.attr("data-id"))}$.each(G,function(H,I){if($.inArray(I,D.ids)==-1){if(I==="3"){C.find(".s-music-entry").hide();F.call("newmusic:index","stop")}c.get(I).del4Men();c.get(I).getMyMen().removeClass("current")}});$.each(D.items,function(H,J){if(c.get(J.id)){var I=c.get(J.id).getMyMen();I.css("display","");if(J.id==="3"){I.appendTo(B.parent());C.find(".s-music-entry").show();$("#s_mancard_newmusic").show();F.call("newmusic:index","init")}else{I.appendTo(B)}if(I.hasClass("current")){z=J.id}}else{c.add(J.id,J.name,"1").add2Men()}});if(D.items.length===0||(D.items.length===1&&D.ids[0]==="3")){z="100"}if(s_session.curmod==="100"){return}if(z!==s_session.curmod){if(z!==null){c.switchCard(z)}else{z=D.ids[0]==="3"?D.ids[1]:D.ids[0];c.switchCard(z)}}}}}}}}});m.listen("superman:page/scroll","outMenu",function(A){if(!A.out){$("#s_top_wrap .s-top-nav").css("display","none")}});s.moreUpFy();$(o).bind("resize",function(A){g=$(this).height();d.barTop=h.offset().top;s.moreUpFy(undefined,true)}).on("scroll",function(C){if(s_session.index_off||s_session.index_guide){return}var B=$(this).scrollTop();var A=$(document).height();if(Math.abs(B+g-A)<=s.tolerance&&s.preTop<B){s.judgeFire()}s.preTop=B;d.judgeMenu(B);d.toggleMenu(B);d.feedRoller(B);setTimeout(function(){b.itemShowLog()},300);s.moreUpFy(undefined,true)});$(o).on("s-skinon",function(){s.moreUpFy(true)});$(o).on("s-skinoff",function(){s.moreUpFy(false)});$(document.body).on("mousewheel",y).on("keydown",y);function y(A){if(s_session.index_guide){return}if((document.documentElement.scrollHeight<=document.documentElement.clientHeight&&A.deltaY<0)||($(o).scrollTop()+$(o).height()-$(document).height()>=-2&&s.tolerance===0&&(A.deltaY<0||A.keyCode===40))){s.tolerance=s.defaulSub;s.judgeFire()}}var x=false;m.listen("mancard:skeleton/card","cardloaded",function(){if(!x){$("#bottom_container").appendTo("#s_wrap");x=true}})}function p(){b.itemShowLog();setTimeout(function(){m.fire("modShow",{showTab:c.curId,opType:"refresh"})},1000)}w.init=q;w.forceMenu=r;w.judgeFire=function(){s.tolerance=300;s.judgeFire()}});F.call("mancard:skeleton/presenter","init");F.module("mancard:skeleton/card_tab",function(c,b,a){var f=c("skeleton/card_collection");var d=/childId=(.+);/;var g=/lasttab/;function e(h){this.initialize(h)}e.prototype={initialize:function(i){var h=this;var j=F.mix({cardName:null,componentWrap:null,content:null,cardTabClass:"card-tab",tabNameClass:"tab-name",tabNameCurClass:"tab-name-cur",tabContentClass:"tab-content",tabContentWrapClass:"tab-content-wrap",dataTabName:"data-childid"},i);h.cardName=j.cardName;h.componentWrap=j.componentWrap;h.content=j.content;h.tabNameClass=j.tabNameClass;h.tabNameCurClass=j.tabNameCurClass;h.tabContentClass=j.tabContentClass;h.dataTabName=j.dataTabName;h.mainDom=h.componentWrap.parent();var k=h.mainDom.attr("data-id");h.card=f.get(k);h.sessionIds={};h.offsets={};h.noMores={};h.dataWaterPara="";h.render(j);h.bindEvent()},render:function(i){var h=this;h.tabs=h.componentWrap.find("."+i.cardTabClass);h.curTab=h.tabs.find("."+h.tabNameCurClass).attr(h.dataTabName);h.dataWaterPara=h.mainDom.attr("data-waterpara")||"";if(!h.dataWaterPara.match(d)){h.dataWaterPara=h.dataWaterPara+"childId="+h.curTab+";";h.mainDom.attr("data-waterpara",h.dataWaterPara)}h.componentWrap.attr("data-curtab",h.curTab);h.content.wrap('<div class="'+i.tabContentWrapClass+'"></div>');h.contentWrap=h.componentWrap.find("."+i.tabContentWrapClass);h.content.addClass("tab-content").attr(h.dataTabName,h.curTab).attr("data-load","loaded").show();h.sessionIds[h.curTab]=h.card.sessionId;h.offsets[h.curTab]=h.card.waterPage;h.noMores[h.curTab]=h.card.noMore},bindEvent:function(){var h=this;var i=['<div class="s-content-load s-opacity-white-background">','<img src="#{staticUrl}static/superman/img/loading.gif?v=62199978.gif" />',"<div>加载中，精彩马上呈现</div>","</div>"].join("");i=$.formatString(i,{staticUrl:s_domain.staticUrl});var j;a.listen("mancard:skeleton/card",["syncNomore"],function(k){h.sessionIds[j]=h.card.sessionId;h.card.sessionId=h.sessionIds[h.curTab];h.card.noMore=true;h.noMores[j]=h.card.noMore;h.contentWrap.find("["+h.dataTabName+'="'+j+'"]').attr("data-load","loaded").append(k);h.card.setForceLoad(false)});h.tabs.delegate("."+h.tabNameClass,"mouseenter",function(o){var m=this;var n=$(this).prop("className");if(g.exec(n)&&g.exec(n)[0]==="lasttab"){return}var k=$(this).attr(h.dataTabName);j=k;var l=h.contentWrap.find("["+h.dataTabName+'="'+k+'"]');if(l.length===0){l=$('<div class="'+h.tabContentClass+'"></div>').attr(h.dataTabName,k).appendTo(h.contentWrap);l.attr("data-load","loading").append(i);h.card.setForceLoad(true);h.card.addParam("childId",k);h.card.load(function(p){h.sessionIds[k]=h.card.sessionId;h.card.sessionId=h.sessionIds[h.curTab];h.card.noMore=h.noMores[k]||false;h.noMores[k]=h.card.noMore;h.card.ridsHash={};l.attr("data-load","loaded").append(p);h.card.setForceLoad(false);if(h.curTab===k){if(!$(m).attr("data-firstLoad")){h.card.waterLoading=false;h.card.appendData(function(q){$("#s_mancard_main").find(".s-more-bar").hide();$(m).attr("data-firstLoad",1)},false,l)}}h.contentWrap.find(".s-content-load").remove()})}}).delegate("."+h.tabNameClass,"click",function(q){var o=this;q.stopPropagation();var p=$(this).prop("className");if(g.exec(p)&&g.exec(p)[0]==="lasttab"){a.fire("clicklastTab");return}$(o).trigger("mouseenter");var k=h.tabs.find("."+h.tabNameCurClass).removeClass(h.tabNameCurClass).attr(h.dataTabName);var l=$(this).addClass(h.tabNameCurClass).attr(h.dataTabName);h.dataWaterPara=h.dataWaterPara.replace(d,"childId="+l+";");h.mainDom.attr("data-waterpara",h.dataWaterPara);a.fire("clickTab",{tabName:$(this).prop("className"),childId:$(this).attr("data-childid")});if(k===l){return}h.offsets[k]=h.card.waterPage;h.noMores[k]=h.card.noMore;h.card.waterPage=h.offsets[l]||0;h.card.noMore=h.noMores[l]||false;h.card.ridsHash={};h.card.sessionId=h.sessionIds[l];if(!h.card.noMore){h.card.resetNoMore()}else{$(".load-done").remove();$(".s-content-load").remove();h.card.emitNoMore()}var n=h.contentWrap.find("["+h.dataTabName+'="'+k+'"]');var m=n.siblings("["+h.dataTabName+'="'+l+'"]');n.hide();m.show();h.curTab=l;if(h.card.id!="5"){h.setTargetTab(l)}h.card.waterDom=m;if(!h.sessionIds[l]){return}h.card.waterLoading=false;if(!$(o).attr("data-firstLoad")){h.card.appendData(function(r){$("#s_mancard_main").find(".s-more-bar").hide();$(o).attr("data-firstLoad",1)},false,m)}})},setTargetTab:function(j,h){var i=this;F.use("mancard:skeleton/card_memory",function(k){k.setCardTab(i.cardName,j);h&&h()})}};return e});F.module("mancard:setting/card_setting",function(n,A,t){var q=n("superui:util/emitter"),x=n("superui:util/dot"),c=n("superman:common/user_attr"),j=x.compile(['<div class="s-cardsetting" id="s_content_99" data-id="99">','<div class="s-cardsetting-wrap clearfix">','<div class="s-cardsetting-left">',"<h3>已订阅频道</h3>",'<div style="float:left;width:78px;text-align:center;margin-top:18px;border:1px solid #cdcdcd;height:24px;line-height:24px;">我的关注</div>','<div class="s-cardsetting-content">',"{{~it.selected :value:index}}",'<div class="s-mod-item {{ if(value.name == "音乐"){ }}s-mod-music s-mod-undraggable{{ } }}" id="s_moditem_{{=value.id}}" data-id="{{=value.id}}" data-imgname="{{=value.imgname}}" data-name="{{=value.name}}">','<div class="s-mod-icon">',"</div>",'<div class="s-mod-title">',"{{=value.name}}","</div>","</div>","{{~}}",'<div class="noremove-tips">','<p>亲，就剩我老哥一个了，不能再删了~可以尝试点击右下角“<a class="tips-hide" href="javascript:void(0)">隐藏频道</a>”收起全部内容。</p>','<b class="close-icon" title="关闭"></b>',"</div>",'<div class="drag-tips">','<p>拖动可以排序<a class="i" href="javascript:void(0)">我知道了</a></p>',"<b></b>","</div>","</div>","</div>",'<div class="s-cardsetting-right">',"<h3>未订阅频道</h3>",'<div class="s-cardsetting-content">',"{{~it.unselected :value:index}}",'<div class="s-mod-item {{ if(value.name == "音乐"){ }}s-mod-music s-mod-undraggable{{ } }}" id="s_moditem_{{=value.id}}" data-id="{{=value.id}}" data-imgname="{{=value.imgname}}" data-name="{{=value.name}}">','<div class="s-mod-icon">',"</div>",'<div class="s-mod-title">',"{{=value.name}}","</div>","</div>","{{~}}","</div>","</div>","</div>",'<div class="s-cardsetting-set-wrapper">','<div class="s-cardsetting-set clearfix">',"{{? it.expand}}","{{~it.expand :value:index}}","{{? value.tipsunknown}}",'<span class="scene-recomm-unknown"></span>',"{{?}}",'<a href="#" onclick="return false;"  class="hide-mods {{=value.otherClassName}}"  hidefocus><span class="{{=value.borderClass}} {{=value.reviewCheck}}" id="{{=value.myId}}" data-attr="{{=value.tips}}"></span><span>{{=value.description}}</span></a>',"{{~}}",'<a href="#" onclick="return false;" class="hide-mods" id="s_hide_allmods" hidefocus=""><span class="bg"></span><span>隐藏频道</span></a>',"{{?}}","</div>","</div>","</div>"].join("")),l='<div class="s-mod-tips">',v="",o="拖动到这里可以取消订阅",y="mod-hover",k="hide-mods",a="."+k,z="s-mod-item",m="."+z,u=".s-cardsetting-left .s-cardsetting-content",r=".s-cardsetting-right .s-cardsetting-content",s=n("superui:component/draggselect"),e=n("superman:common/user_attr"),g=n("superui:component/dialog"),w=n("superui:component"),d=true,p=false,f=n("skeleton/card_collection"),b={mod:s_domain.baseuri+"/pcweb/submit/mancardmod",menu:s_domain.baseuri+"/pcweb/submit/mancardmenu"};var h=null;function i(){this.initialize()}i.prototype={constructor:i,initialize:function(){this.main=$("#s_main");this.textarea=$("#s_menus_textarea");this.addedcache=[];if(this.textarea.length){this.selected=[];this.unselected=[];this.cache=$.parseJSON(this.textarea.val());this.render()}this.__datas=[]},renderTips:function(){var B,C=this;C.dialog.body.on("click",".scene-recomm-unknown",function(){if(!B){F.use("superui:component/tips",function(E){var D=$(".scene-recomm-unknown",C.dialog.body);B=new E({componentWrap:C.dialog.body,target:D,identity:"scene-recommend",content:['<div class="scene-recommend-content">','<div class="scene-recommend-content">',"<h2>情景推荐模式：</h2>",'<p class="title">即当您登录百度首页时，页面会优先切换到您此时可能感兴趣的内容。</p>',"<p>例：您习惯看各种资讯，一大早打开电脑，会优先给您推荐新闻；闲暇时会给您切换至视频卡片供您舒缓神经。</p>",'<p class="last s-opacity-border4-top">如若您不喜欢，取消勾选框中的√即可，感谢您的使用~</p>',"</div>"].join(""),align:"center",arrowLeft:"right",autoShow:false,hasClose:false,width:388,theme:"scene-recommend"})})}B.show()})},render:function(){var B=this,C=[];var D=null;F.each(B.cache.data,function(E){if(E.id=="100"){D=E}if(E.ismenu=="1"){if(E.state=="1"){if(E.id===3){B.selected.unshift(E)}else{B.selected.push(E)}}else{B.unselected.push(E)}}});if(s_session.strategy_hit==2){C.push({otherClassName:"content-mod",borderClass:"choice-border",tips:"mouseScrollGuide",myId:"mouseScroll_mod",description:"滚轮切换卡片",reviewCheck:s_session.userTips.mouseScrollGuide?"checked":""})}C.push({otherClassName:"content-mod",borderClass:"choice-border",tips:"conRecommendTip",myId:"conRecommend_mod",description:"情景推荐",tipsunknown:true,reviewCheck:s_session.userTips.conRecommendTip?"checked":""});B.expand=C},init:function(){var B=this;dialog=B.dialog;dialog.body.on("mouseenter mouseleave",m,function(C){var D=$(C.target).closest(m);D[C.type=="mouseenter"?"addClass":"removeClass"](y)});B.bindDrag();dialog.on("onHide",function(E){$("#s_main").removeClass("sui-cardsetting-main");s_session.skeleton_stopanimated=false;var C=B.getItems(),D={};t.fire("hideSet",C);B.dialog.log("hide")});B.bindEvent()},bindEvent:function(){var B=this,C=B.dialog.body.find(".drag-tips"),E=B.dialog.body.find(".tips-hide"),D=B.dialog.body.find(".close-icon");C.on("click",function(){F.use("common/user_attr",function(G){G.setAttr("settingDragTips",false);C.css("display","none")})});E.on("click",function(G){B.hideMain();G.stopPropagation()});$(document).on("mousedown",function(G){if($(G.target).hasClass("menu-icon")){return}B.hide();p=false});D.on("click",function(G){B.dialog.body.find(u).find(".noremove-tips").css("display","none")});t.listen("mancard:skeleton/presenter","overCenter",function(G){if(!!G.over){B.hide()}});t.listen("mancard:skeleton/card_collection","showTopMenu",function(G){if(!G.show){B.hide()}});$(window).on("scroll",function(){})},save:function(){var C=this,B=C.packed;setTimeout(function(){t.fire("modOperate",B)},100)},pack:function(E){var B=this,C,D=E.dragItem;B.packed={ismenu:1,cmd:E.type=="added"?"add":E.type=="remove"?"del":"sort"};C=B.getIDS();B.packed.ids=C.ids;B.packed.names=C.names;if(D){B.packed.id=D.attr("data-id");B.packed.name=D.attr("data-name")}B.save()},getIDS:function(){var E={ids:[],names:[]},B=this.draggselect.selected,D=B.drags,C=B.cache;F.each(C,function(J){var I=D.eq(J),G=I.attr("data-id"),H=I.attr("data-name");E.ids.push(G);E.names.push(H)});return E},getItems:function(){var D=[],G=[],B=this.draggselect.selected,E=B.drags,C=B.cache;F.each(C,function(K){var J=E.eq(K),H=J.attr("data-id"),I=J.attr("data-name");G.push(H);D.push({name:I,id:H})});return{ids:G,items:D}},tips:function(){var B=this,E,D,C=B.draggselect;E=C.selected;D=C.unselected;if(!E.tipsmessage){E.tipsmessage=$(l).html(o).appendTo(E.wrap)}if(!D.tipsmessage){D.tipsmessage=$(l).html(v).appendTo(D.wrap)}if(E.total==0){D.tipsmessage.show();E.tipsmessage.hide()}else{D.tipsmessage.hide();if(D.total==0){D.tipsmessage.hide();E.tipsmessage.show()}else{E.tipsmessage.hide()}}D.tipsmessage.hide()},cacheAdded:function(E){var C=this,D,G,B=this.addedcache;if(E.dragItem){G=E.dragItem.attr("data-id");D=$.inArray(G,B);if(D>-1){B.splice(D,1)}if(E.type=="added"){B.push(G)}}},bindDrag:function(){var B=this,C=B.dialog,D;if(C.body.find(u).width()>530){B.bugtotal=B.bugtotal||0;if(B.bugtotal++<100){return setTimeout(function(){B.bindDrag()},200)}}B.draggselect=new s({identity:"cardsetting",containment:C.body,selected:C.body.find(u),unselected:C.body.find(r),dragsort:m,cansort:false,afterAnimateTime:100});B.draggselect.on("onBeforeSelect",function(G){h=G.dragItem;h.css("zoom","0");var E=G.dragItem.parent().parent();B.dialog.body.find(".drag-tips").css("display","none");if(G.dragItem){G.dragItem.removeClass(y);if(h.text()==="音乐"){$(".sui-draggsort-holder").addClass("lock");B.draggselect.selected.__options.cansort=false}}});B.draggselect.on("onAfterSelect",function(E){setTimeout(function(){B.resort()},B.draggselect.selected.__options.afterAnimateTime+50);B.draggselect.selected.__options.cansort=true;if(h){setTimeout(function(){h.css("zoom","1");h=null},50)}$(".sui-draggsort-holder").removeClass("lock")});B.draggselect.on("onBeforeSelectSwap",function(){B.dialog.body.find(".drag-tips").css("display","none");B.draggselect.selected.parentoffset=$(".s-cardsetting-left .s-cardsetting-content").offset();B.draggselect.unselected.parentoffset=$(".s-cardsetting-right .s-cardsetting-content").offset()});B.draggselect.on("onSelectSwap",function(K){K.dragItem&&K.dragItem.removeClass("mod-hover");if(K.dragItem&&$.isIE){K.dragItem.removeClass("mod-hover");setTimeout(function(){},100)}B.checkLeave();switch(K.type){case"added":cmd="add";break;case"remove":cmd="del";var J=K.dragItem,E,L;B.cacheAdded(K);if(J&&J.length){if(K.type=="remove"){B.tips(true)}else{B.tips()}J.removeClass(y)}break;case"noremove":B.dialog.body.find(".drag-tips").hide();break;case"switch":cmd="sort";break}if(!h){B.resort()}B.pack(K);if(s_session.userTips.firstMahattan){F.use("superman:common/user_attr",function(N){N.setAttr("firstMahattan",false)})}$.ajaxpost(b.mod,{cmd:B.packed.cmd,id:K.dragItem?K.dragItem.attr("data-id"):undefined,ids:B.packed.ids.join(",")},function(N){});var H=f.getMenuIDS();var M=B.getItems().ids;for(var G=0;G<H.length;G++){var I=f.get(H[G]).getMyMen();if(I.hasClass("current")&&$.inArray(H[G],M)==-1){$.ajaxpost(b.menu,{id:M[0]},function(N){})}}});B.draggselect.on("onAfterSelect",function(E){p=true;B.checkLeave()});B.draggselect.on("onResizeHeight",function(E){});B.draggselect.on("beforeMoving",function(){C.body.find(u).find(".noremove-tips").css("display","none")});B.bindExpand();B.renderTips();B.tips(true);B.checkLeave()},checkLeave:function(){var B=this;leftHave=B.dialog.body.find(u).find(m).length;d=leftHave==1?false:true},bindExpand:function(){var B=this,C=B.dialog;C.body.on("click",function(H){var I=$(H.target).closest(a),E,D,G;if(I.length){E=I.find("span").eq(0);if(D=E.attr("data-attr")){G=E.toggleClass("checked").hasClass("checked");e.setAttr(D,G);B.draggselect.log(D,"checked="+G)}else{B.draggselect.log("hidemain");B.hideMain()}return false}})},hideMain:function(B){if(!B){this.dialog.hide()}t.fire("hideMain");$("body").addClass("is-lite")},show:function(D){var B=this,C;B.current=D.current;if(B.cache){if(!B.dialog){$("#s_main").addClass("sui-cardsetting-main");B.dialog=new g({identity:"cardsetting",width:C=B.main.width(),content:j({expand:B.expand,unselected:B.unselected,selected:B.selected}),position:function(){return{top:"36px",width:"895px",left:"0px"}},theme:"cardsetting",autoShow:false,hasMask:false,hasClose:false,componentWrap:$("#s_main"),hackToTop:false});B.dialog.on("onShow",function(){$("#s_main").addClass("sui-cardsetting-main");s_session.skeleton_stopanimated=true;if(!B.binded){setTimeout(function(){B.init(B.binded=true)},100)}})}if(!s_session.userTips.settingDragTips||B.selected.length==0){B.dialog.body.find(".drag-tips").css("display","none")}B.dialog.show();B.beforeShow();if($.isIE6){$(".sui-dialog-cardsetting .sui-dialog-body").show()}else{if(true){$(".sui-dialog-cardsetting .sui-dialog-body").css({display:"block"});$(".sui-dialog-cardsetting").animate({height:"186px"},200)}else{}}t.fire("showSet")}B.dialog.hasshow=true;$(".sui-dialog-body").on("click",function(E){E.stopPropagation()});B.dialog.body.on("mousedown",function(E){E.stopPropagation()});F.use("common/user_attr",function(E){E.setAttr("settingDragTips",false)})},hide:function(){var B=this;if(B.isShow()){if($.isIE6){$(".sui-dialog-cardsetting .sui-dialog-body").hide();B.dialog.hide()}else{$(".sui-dialog-cardsetting").animate({height:"0px"},200,function(){$(".sui-dialog-cardsetting .sui-dialog-body").css({display:"none"});B.dialog.hide()})}}},isShow:function(){if($(".sui-dialog-cardsetting .sui-dialog-body").length==0||$(".sui-dialog-cardsetting .sui-dialog-body").css("display")=="none"){return false}else{return true}},beforeShow:function(){var B=this,D=$("#s_top_wrap"),C=$(".sui-dialog-cardsetting");if(D.find("#s_menu_gurd").length>0){if($.isIE6){C.css("position","absolute");C.css("top",$(window).scrollTop()-$("#s_main").offset().top+110+"px")}else{C.css("position","fixed");C.css("top","110px");C.css("left",$("#s_main").offset().left)}}else{C.css("position","absolute");C.css("top","36px")}},resort:function(){var D=this.draggselect.selected.cache;var C=parseInt($(".s-cardsetting-left .s-mod-music:last").attr("data-daraggsort"),10);if(!isNaN(C)){var B;for(var E=0,G=D.length;E<G;E++){if(C===D[E]&&E!==0){D.splice(E,1);D.unshift(C);this.draggselect.selected.sort(false,true);break}}}}};return new (F.inherit(i,q))()});F.module("mancard:subscribe/parabola",function(j,x,m){(function(){var b=0;var c=["webkit","moz"];for(var a=0;a<c.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(D,A){var z=new Date().getTime();var B=Math.max(0,16.7-(z-b));var C=window.setTimeout(function(){D(z+B)},B);b=z+B;return C}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(z){clearTimeout(z)}}}());var k={speed:166.67,curvature:0.001,progress:function(){},complete:function(){i&&i()}};var d,w,i;var s={},h=h||{};for(var y in k){s[y]=h[y]||k[y]}x={mark:function(){return this},position:function(){return this},move:function(){return this},init:function(){return this}};var e="margin",u=document.createElement("div");if("oninput" in u){["","ms","webkit"].forEach(function(b){var a=b+(b?"T":"t")+"ransform";if(a in u.style){e=a}})}var v=s.curvature,t=0,r=0;var n=true;var q={},l={};var g={},p={};var f={},o={};x.mark=function(){if(n==false){return this}if(typeof f.x=="undefined"){this.position()}d.setAttribute("data-center",[f.x,f.y].join());w.setAttribute("data-center",[o.x,o.y].join());return this};x.position=function(){if(n==false){return this}var b=document.documentElement.scrollLeft||document.body.scrollLeft,a=document.documentElement.scrollTop||document.body.scrollTop;if(e=="margin"){d.style.marginLeft=d.style.marginTop="0px"}else{d.style[e]="translate(0, 0)"}q=d.getBoundingClientRect();l=w.getBoundingClientRect();g={x:q.left+(q.right-q.left)/2+b,y:q.top+(q.bottom-q.top)/2+a};p={x:l.left+(l.right-l.left)/2+b,y:l.top+(l.bottom-l.top)/2+a};f={x:0,y:0};o={x:-1*(g.x-p.x),y:-1*(g.y-p.y)};t=(o.y-v*o.x*o.x)/o.x;return this};x.move=function(){if(n==false){return this}var a=0,b=o.x>0?1:-1;var c=function(){var A=2*v*a+t;a=a+b*Math.sqrt(s.speed/(A*A+1));if((b==1&&a>o.x)||(b==-1&&a<o.x)){a=o.x}var z=a,B=v*z*z+t*z;d.setAttribute("data-center",[Math.round(z),Math.round(B)].join());if(e=="margin"){d.style.marginLeft=z+"px";d.style.marginTop=B+"px"}else{d.style[e]="translate("+[z+"px",B+"px"].join()+")"}if(a!==o.x){s.progress(z,B);window.requestAnimationFrame(c)}else{s.complete();n=true}};window.requestAnimationFrame(c);n=false;return this};x.init=function(c,b,a){d=c;w=b;i=a;this.position().mark().move()};return x});F.module("mancard:subscribe/subscribe",function(j,x,o){var d=j("mancard:skeleton/card_collection");var v=["s_ctner_contents"],s=false,k,r=$('<div class="sub-anistar"><b></b></div>'),p=$('<div class="sub-anipic">							<div class="sub-ie-mask"></div>						</div>'),q=[],c=$('<div class="sub-aniadd"></div>'),l=$('<div class="sub-anistaradd"></div>'),a=$("#head"),n=s_domain.baseuri+"/subscribe/submit/manoperation ",i="data-subscribe",w="data-rid",h="data-subparam",f=0;var e=j("superui:component/tips");var b=function(y){$("#"+y).on("mouseenter mouseleave","["+i+"]",function(A){var z=A.target;if(A.type==="mouseenter"){window.debugenter=function(){var B;if((B=$(this).find(".subscribe"))[0]){B.show();if($(this).attr(i)=="1"){g("1",B)}else{g("0",B)}return}var C=$('<div class="subscribe" data-click="LOG_BTN_SUB"><div class="sub"><em class="sub-bg"></em><b class="sub-star"></b><span class="sub-txt" style="display:none">已关注</span></div></div>');if($(this).attr(i)=="1"){g("1",C)}else{g("0",C)}if($(this).find(".sub-contaniner").length>0){$(this).find(".sub-contaniner").append(C)}else{$(this).append(C)}if($.isIE6){C.css("zoom","1")}};window.debugenter.call(this)}else{if(A.target!=$(this).find(".subscribe").find(".sub-star")[0]){$(this).find(".subscribe").css("zoom","0").detach()}}}).on("click",".subscribe",function(z){u($(this),$(this));z.stopPropagation()})};var g=function(y,A){var z=A.children();if(y=="1"){z.removeClass("unsub");z.addClass("sub");A.attr("data-click","LOG_BTN_UNSUB");A.find(".sub-txt").text("已关注");if(s_session.curmod=="20"){A.attr("title","已关注,点击取消")}}else{if(y=="0"){z.removeClass("sub");z.addClass("unsub");A.attr("data-click","LOG_BTN_SUB");A.find(".sub-txt").text("关注");if(s_session.curmod=="20"){A.attr("title","添加到关注")}}}};var u=function(J,H){var E=J,D=E.parents("["+i+"]"),I=D.attr(i),z=D.attr(w),y=D.attr(h),G,A={id:z};if(y){var C=/([^:]+):([^;]+);/gi,B;while((B=C.exec(y))){A[B[1]]=B[2]}}if(I=="1"){G="del";A.cmd=G;m(D,A,function(){D.attr(i,"0");g("0",H)})}else{G="add";A.cmd=G;t(D,A,function(){D.attr(i,"1");g("1",H)})}D.parents(".s-xmancard").attr("data-subChange",1)};function t(D,E,y){var G=D.offset();var C=$("#s_menu_mine .mine-icon").offset();var z=p.clone();z.attr("class","sub-anipic sub-anipic-"+s_session.curmod);var B=D.closest("["+w+"]").find("img").attr("src");var A={tabid:window.s_session.curmod,url:D.find("a").attr("href")||"",name:D.find("a").attr("title")||"",from:window.s_session.curmod};$.extend(A,E);$.ajaxpost(n,A,function(I){var H=I.errNo;if(H=="0"||H=="6004"){y&&y();o.fire("refresh",{tabid:A.tabid,param:A,response:I,actItem:D});if($.isIE6){return}if($.isIE&&$.browser.ie<9&&s_session.userSkinOpacity>20){z.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=scale, src='"+B+"')"})}else{z.css({"background-image":"url("+B+")"});z.css({filter:"none"})}setTimeout(function(){C=$("#s_menu_mine .mine-icon").offset();var J=-parseInt($("#s_menu_gurd").css("margin-top"),10);z.animate({left:C.left-10+"px",top:C.top-7+J+"px"},1000,function(){z.fadeOut(function(){z.remove()});var K=l.clone();K.css({left:C.left,top:C.top});a.append(K);K.show();K.animate({top:C.top-40,opacity:"0"},2000,function(L){K.remove()})})},0);z.css({left:G.left+45,top:G.top});a.append(z);if(d.options("menuStatus")=="2"||d.options("menuStatus")=="1"){F.call("mancard:skeleton/presenter","forceMenu")}}else{if(H=="501"){o.fire("showExceedTips",{tabid:A.tabid})}else{}}})}function m(A,B,y){var z={tabid:window.s_session.curmod,url:A.find("a").attr("href")||"",name:A.find("a").attr("title")||"",from:window.s_session.curmod};$.extend(z,B);$.ajaxpost(n,z,function(D){var C=D.errNo;if(C=="0"){y&&y();setTimeout(function(){o.fire("refresh",{tabid:z.tabid,param:z,response:D,actItem:A})},1000)}else{}})}x.init=function(){$.each(v,function(y,z){b(z)})};x.subAdd=t;x.subDel=m});F.call("mancard:subscribe/subscribe","init");